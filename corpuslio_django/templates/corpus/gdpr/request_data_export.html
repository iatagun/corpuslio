{% extends "corpus/base.html" %}

{% block title %}Veri İhracı Talebi{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{% url 'corpus:privacy_settings' %}">Gizlilik Ayarları</a></li>
                    <li class="breadcrumb-item active">Veri İhracı</li>
                </ol>
            </nav>
            
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0"><i class="fas fa-download"></i> Verilerimi İndir</h4>
                </div>
                <div class="card-body">
                    {% if messages %}
                        {% for message in messages %}
                        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                            {{ message }}
                            <button type="button" class="close" data-dismiss="alert">
                                <span>&times;</span>
                            </button>
                        </div>
                        {% endfor %}
                    {% endif %}
                    
                    <div class="alert alert-info">
                        <h5><i class="fas fa-info-circle"></i> Veri Taşınabilirliği Hakkı</h5>
                        <p class="mb-0">
                            KVKK ve GDPR kapsamında, platformdaki tüm kişisel verilerinizi 
                            yapılandırılmış ve makine tarafından okunabilir formatta (JSON/CSV) 
                            indirme hakkına sahipsiniz.
                        </p>
                    </div>
                    
                    <h5>İndirilecek Veriler</h5>
                    <p>Aşağıdaki veri kategorileri export dosyasına dahil edilecektir:</p>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <ul class="list-group mb-3">
                                <li class="list-group-item">
                                    <i class="fas fa-user text-primary"></i> 
                                    <strong>Hesap Bilgileri</strong>
                                    <br><small class="text-muted">Kullanıcı adı, e-posta, kayıt tarihi</small>
                                </li>
                                <li class="list-group-item">
                                    <i class="fas fa-id-card text-success"></i> 
                                    <strong>Profil Bilgileri</strong>
                                    <br><small class="text-muted">Kurum, rol, doğrulama durumu</small>
                                </li>
                                <li class="list-group-item">
                                    <i class="fas fa-file-alt text-info"></i> 
                                    <strong>Belgeler</strong>
                                    <br><small class="text-muted">Yüklediğiniz dokümanlar ve meta verileri</small>
                                </li>
                                <li class="list-group-item">
                                    <i class="fas fa-search text-warning"></i> 
                                    <strong>Sorgu Geçmişi</strong>
                                    <br><small class="text-muted">Son 1000 arama sorgunuz</small>
                                </li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <ul class="list-group mb-3">
                                <li class="list-group-item">
                                    <i class="fas fa-file-export text-danger"></i> 
                                    <strong>İhracat Logları</strong>
                                    <br><small class="text-muted">Export ve indirme kayıtları</small>
                                </li>
                                <li class="list-group-item">
                                    <i class="fas fa-check-circle text-success"></i> 
                                    <strong>İzin Kayıtları</strong>
                                    <br><small class="text-muted">Consent geçmişi ve durumu</small>
                                </li>
                                <li class="list-group-item">
                                    <i class="fas fa-key text-secondary"></i> 
                                    <strong>API Anahtarları</strong>
                                    <br><small class="text-muted">Oluşturduğunuz API keys (varsa)</small>
                                </li>
                                <li class="list-group-item">
                                    <i class="fas fa-clock text-muted"></i> 
                                    <strong>Meta Veriler</strong>
                                    <br><small class="text-muted">Tarih, platform, versiyon</small>
                                </li>
                            </ul>
                        </div>
                    </div>
                    
                    <hr>
                    
                    <form method="post" class="mt-4">
                        {% csrf_token %}
                        
                        <div class="form-group">
                            <label for="format"><strong>İhracat Formatı Seçin:</strong></label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="format" id="format_json" value="json" checked>
                                <label class="form-check-label" for="format_json">
                                    <strong>JSON</strong> - Yapılandırılmış veri formatı
                                    <br><small class="text-muted">Teknik kullanıcılar için, programatik erişim</small>
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="format" id="format_csv" value="csv">
                                <label class="form-check-label" for="format_csv">
                                    <strong>CSV</strong> - Excel/Tablolarda açılabilir
                                    <br><small class="text-muted">Kolay okunabilir, birden fazla CSV dosyası (ZIP)</small>
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="format" id="format_both" value="both">
                                <label class="form-check-label" for="format_both">
                                    <strong>Her İkisi</strong> - JSON + CSV
                                    <br><small class="text-muted">Tüm formatları indirin</small>
                                </label>
                            </div>
                        </div>
                        
                        <div class="alert alert-warning">
                            <h6><i class="fas fa-exclamation-triangle"></i> Önemli Bilgiler:</h6>
                            <ul class="mb-0">
                                <li><strong>İşlem Süresi:</strong> Verileriniz birkaç saniye içinde hazırlanacaktır</li>
                                <li><strong>Geçerlilik:</strong> İndirme linki <strong>30 gün</strong> süreyle geçerlidir</li>
                                <li><strong>Günlük Limit:</strong> Günde en fazla <strong>5 talep</strong> oluşturabilirsiniz</li>
                                <li><strong>Güvenlik:</strong> Dosyalar yalnızca sizin tarafınızdan indirilebilir</li>
                                {% if pending_exports > 0 %}
                                <li class="text-danger"><strong>Mevcut Talepler:</strong> {{ pending_exports }} adet bekleyen talebiniz var</li>
                                {% endif %}
                            </ul>
                        </div>
                        
                        <div class="form-group">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="confirm" required>
                                <label class="form-check-label" for="confirm">
                                    Yukarıdaki bilgileri okudum ve anladım. Veri ihracı talebimi onaylıyorum.
                                </label>
                            </div>
                        </div>
                        
                        <div class="d-flex justify-content-between">
                            <a href="{% url 'corpus:privacy_settings' %}" class="btn btn-secondary">
                                <i class="fas fa-arrow-left"></i> Geri Dön
                            </a>
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-download"></i> Veri İhracı Talep Et
                            </button>
                        </div>
                    </form>
                    
                    <hr class="mt-4">
                    
                    <div class="text-center">
                        <p class="text-muted mb-0">
                            <small>
                                Mevcut taleplerinizi görmek için 
                                <a href="{% url 'corpus:data_export_list' %}">Taleplerim</a> sayfasını ziyaret edin.
                            </small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
